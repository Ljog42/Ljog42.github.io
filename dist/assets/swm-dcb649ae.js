var w=(s,t,e)=>{if(!t.has(s))throw TypeError("Cannot "+e)};var i=(s,t,e)=>{if(t.has(s))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(s):t.set(s,e)};var a=(s,t,e)=>(w(s,t,"access private method"),e);import"./modulepreload-polyfill-3cfb730f.js";class C{constructor(t,e){this.view=t,this.model=e}async fetchAvailable(){await this.model.getAvailableCountries()}async fetchCharts(){await this.model.getCountriesCharts()}async render(t){this.view.buildCards(t),this.view.insertCards(t)}async setAvailable(){await this.fetchAvailable(),this.countries=this.model.availableCountries.map(t=>(t.display=!1,t.HTMLelement=document.getElementById(t.id),t)),await this.view.buildSelectors(this.countries),this.showAvailable()}setSelected(t){t.display=!0}async fetchSelected(t){let e=await this.model.getCountryChart(t);console.log(e),t.track=await e[0].title,t.artist=await e[0].subtitle,t.images=await e[0].images}showSelected(t){t.HTMLelement.classList.toggle("land"),t.HTMLelement.classList.toggle("pays-actifs"),this.view.buildCard(t),this.view.insertCard(t)}showAvailable(){this.view.insertSelectors(this.countries),this.view.selectEvents(this.countries)}}class g{constructor(){this.chartlistUrl="https://shazam.p.rapidapi.com/charts/list",this.options={method:"GET",headers:{"X-RapidAPI-Key":"bb7644f4camsh704f7d5613a7768p12b59bjsn15758ea5893b","X-RapidAPI-Host":"shazam.p.rapidapi.com"}}}async getChartList(){try{return(await(await fetch(this.chartlistUrl,this.options)).json()).countries}catch(t){console.error(t)}}async getCountryChart(t,e){const u=`https://shazam.p.rapidapi.com/charts/track?locale=en-US&listId=${t}&pageSize=${e}&startFrom=0`;try{return(await(await fetch(u,this.options)).json()).tracks}catch(o){console.error(o)}}}class b{constructor(){this.handler=new g}setController(t){this.controller=t}async getAvailableCountries(){this.availableCountries=await this.handler.getChartList()}async getCountryChart(t){return await this.handler.getCountryChart(t.listid,1)}}class v{constructor(t){this.id=t.id,this.track=t.track,this.artist=t.artist,this.images=t.images,this.position=t.HTMLelement.getBoundingClientRect(),this.chartCard=this.create("article"),this.imgDiv=this.create("div"),this.infoSection=this.create("section"),this.header=this.create("h3"),this.trackPara=this.create("p"),this.artistPara=this.create("p"),this.setValues(),this.setAttributes(),this.chartCard.appendChild(this.imgDiv),this.chartCard.appendChild(this.infoSection),this.infoSection.appendChild(this.header),this.infoSection.appendChild(this.trackPara),this.infoSection.appendChild(this.artistPara)}setValues(){this.header.innerHTML="#<b>1</b> in "+this.id,this.trackPara.innerText=this.track,this.artistPara.innerText=this.artist}setAttributes(){this.chartCard.id=this.id,this.chartCard.setAttribute("style",`top: ${parseInt(this.position.y)}px; left: ${parseInt(this.position.x)}px;`),this.chartCard.classList.add("chart-card"),this.imgDiv.classList.add("card-img-div"),this.trackPara.classList.add("card-track"),this.artistPara.classList.add("card-artist"),this.infoSection.classList.add("card-info-section"),this.header.classList.add("card-header"),this.images!=null?this.imgDiv.setAttribute("style",`background-image: url(${this.images.coverart})`):this.imgDiv.setAttribute("style","background-image: url(./Carte/retro-vinyl-record-icon-vector-illustration.jpg)")}create(t){return document.createElement(t)}}class f{constructor(t){this.id=t,this.element=this.create("li"),this.label=this.create("label"),this.switch=this.create("input"),this.setAttributes(),this.setValue(),this.assemble()}setAttributes(){this.label.setAttribute("for",`${this.id}`),this.switch.setAttribute("type","checkbox")}setValue(){this.label.innerText=this.id}assemble(){this.element.appendChild(this.label),this.element.appendChild(this.switch)}create(t){return document.createElement(t)}}class A{setController(t){this.controller=t,this.selectorsList=document.getElementById("selectors-list")}buildCard(t){t.card=new v(t)}buildSelectors(t){t.map(e=>(e.selector=new f(e.id),e))}insertCard(t){console.log(t),document.body.appendChild(t.card.chartCard),t.HTMLelement.onmouseover=()=>{t.card.chartCard.classList.toggle("displayed")},t.HTMLelement.onmouseleave=()=>{t.card.chartCard.classList.toggle("displayed")}}selectEvents(t){t.forEach(async e=>{e.selector.switch.onchange=async()=>{this.controller.setSelected(e),await this.controller.fetchSelected(e),this.controller.showSelected(e)}})}insertSelectors(t){t.forEach(e=>{this.selectorsList.appendChild(e.selector.element)})}}var r,n,l,d,h,p,c,m;class L{constructor(){i(this,r);i(this,l);i(this,h);i(this,c);this.ctrl,this.view,this.model,this.app}getCtrl(){return this.ctrl==null?(a(this,r,n).call(this),this.ctrl):this.ctrl}getView(){return this.view==null?(a(this,l,d).call(this),this.view):this.view}getModel(){return this.model==null?(a(this,h,p).call(this),this.model):this.model}getApp(){return this.app==null?(a(this,c,m).call(this),this.app):this.app}}r=new WeakSet,n=function(){this.ctrl=new C(this.view,this.model),this.ctrl.constructor=()=>this.ctrl},l=new WeakSet,d=function(){this.view=new A,this.view.constructor=()=>this.view},h=new WeakSet,p=function(){this.model=new b,this.model.constructor=()=>this.model},c=new WeakSet,m=function(){this.app={model:this.getModel(),view:this.getView(),controller:this.getCtrl()},this.app.view.setController(this.app.controller),this.app.model.setController(this.app.controller),this.app.constructor=()=>this.app};const S=new L,k=S.getApp();k.controller.setAvailable();
